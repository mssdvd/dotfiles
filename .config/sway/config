set {
	$mod Mod4
	$term foot
	$menu j4-dmenu-desktop --dmenu='bemenu -p "run"' --term=$term --display-binary --no-generic
	$wlsunset_toggle "if pgrep wlsunset; then pkill wlsunset; echo wlsunset killed; else wlsunset -t 2500 -l 45.9 -L 12.6; fi"
}

output {
	"Goldstar Company Ltd LG ULTRAFINE 105NTWGCC849"
	* bg "#000000" solid_color subpixel rgb
}

input {
	"type:touchpad" {
		dwt enabled
		tap enabled
		natural_scroll enabled
		middle_emulation enabled
		pointer_accel 0.8
	}
	"type:pointer" pointer_accel 1
	"type:keyboard" repeat_rate 50
	"type:keyboard" xkb_options "ctrl:swapcaps,compose:ralt"
	"1278:32:PFU_Limited_HHKB-Classic" xkb_options "compose:ralt"
	"1133:49971:Logitech_Gaming_Keyboard_G610" xkb_layout us-english-long-shift
	"1149:32792:Kensington_Expert_Wireless_TB_Mouse" scroll_factor 2
}

# modes

set $mode_display Toggle display output eDP-1 (e), DP-1 (d) | Rotate output (r), reset rotation (R)
mode "$mode_display" {
	bindsym --to-code {
		e output eDP-1 toggle, mode "default"
		d output DP-1 toggle, mode "default"

		r output - transform 90 anticlockwise
		Shift+r output - transform 0

		Return mode "default"
		Escape mode "default"
	}
}

set $mode_system System (l)ock, (e)xit, (s)uspend, (Shift+r)eboot, (Shift+s)hutdown
mode "$mode_system" {
	bindsym --to-code {
		l exec swaylock -f && sleep 1, mode "default"
		e exec emacsclient -e '(save-buffers-kill-emacs 1)', exit, mode "default"
		s exec systemctl suspend, mode "default"
		Shift+r exec "emacsclient -e '(save-buffers-kill-emacs 1)'; systemctl reboot", mode "default"
		Shift+s exec "emacsclient -e '(save-buffers-kill-emacs 1)'; systemctl poweroff -i", mode "default"

		Return mode "default"
		Escape mode "default"
	}
}

set $mode_screenshot Screenshot copy (w)in, (s)creen, (a)rea, save (Shift+w)in, (Shift+s)creen, (Shift+a)rea, swapp(y)
mode "$mode_screenshot" {
	bindsym --to-code {
		w exec grimshot --notify copy win; mode "default"
		Shift+w exec grimshot --notify save win; mode "default"
		s exec grimshot --notify copy screen; mode "default"
		Shift+s exec grimshot --notify save screen; mode "default"
		a exec grimshot --notify copy area; mode "default"
		Shift+a exec grimshot --notify save area; mode "default"
		y exec grim -g "$(slurp)" - | swappy -f -; mode "default"

		Return mode "default"
		Escape mode "default"
		Print mode "default"
	}
}

set $passthrough passthrough mode ($mod+Pause to leave)
mode "$passthrough" {
	bindsym --to-code $mod+Pause mode default
}

mode "resize" {
	bindsym {
		h resize shrink width 50px
		j resize grow height 50px
		k resize shrink height 50px
		l resize grow width 50px

		Left resize shrink width 50px
		Down resize grow height 50px
		Up resize shrink height 50px
		Right resize grow width 50px

		t exec i3_balance_workspace
		Shift+t exec i3_balance_workspace --scope focus

		Return mode "default"
		Escape mode "default"
		r mode "default"
		grave mode "default"
	 }
}


# bindsym

bindsym --to-code {
	$mod+n mode "$mode_display"
	XF86Display mode "$mode_display"
	$mod+Shift+e mode "$mode_system"
	Print mode "$mode_screenshot"
	$mod+Pause mode "$passthrough"
	$mod+r mode "resize"

	XF86Tools output - transform 90 anticlockwise
	Shift+XF86Tools output - transform 0

	$mod+Return exec $term
	# $mod+Shift+Return exec $term --class $term_floating_window
	$mod+Shift+Return exec $term --app-id=$term_floating_window
	$mod+Shift+q kill
	$mod+Tab exec $menu

	$mod+Shift+c reload

	XF86MonBrightnessUp exec light -A 5
	Shift+XF86MonBrightnessUp exec light -A 1
	$mod+o exec light -A 5
	$mod+Shift+o exec light -A 1
	XF86MonBrightnessDown exec light -U 5
	Shift+XF86MonBrightnessDown exec light -U 1
	$mod+i exec light -U 5
	$mod+Shift+i exec light -U 1

	$mod+Shift+x exec pavucontrol

	--locked {
		XF86AudioRaiseVolume exec pactl set-sink-volume @DEFAULT_SINK@ +5%
		$mod+x exec pactl set-sink-volume @DEFAULT_SINK@ +5%
		XF86AudioLowerVolume exec pactl set-sink-volume @DEFAULT_SINK@ -5%
		$mod+z exec pactl set-sink-volume @DEFAULT_SINK@ -5%
		XF86AudioMute exec pactl set-sink-mute @DEFAULT_SINK@ toggle
		$mod+c exec pactl set-sink-mute @DEFAULT_SINK@ toggle
		Shift+XF86AudioMute exec ~/bin/switch_audio_sink.sh
		$mod+Shift+z exec ~/bin/switch_audio_sink.sh
		XF86AudioMicMute exec pactl set-source-mute @DEFAULT_SOURCE@ toggle

		XF86AudioPlay exec playerctl play-pause
		$mod+Slash exec playerctl play-pause
		XF86AudioStop exec playerctl stop
		XF86AudioNext exec playerctl next
		$mod+Period exec playerctl next
		XF86AudioPrev exec playerctl previous
		$mod+Comma exec playerctl previous
	}

	XF86Launch2 exec $wlsunset_toggle
	$mod+u exec $wlsunset_toggle

	$mod+Bracketleft exec firefox
	$mod+Shift+Bracketleft exec firefox --private-window
	$mod+Backslash exec $term ranger
	$mod+Shift+Backslash exec pcmanfm-qt
	$mod+Bracketright exec emacsclient -c -a ''

	# $mod+p exec passmenu --type
	$mod+Shift+apostrophe exec evince
	$mod+apostrophe exec zathura
	$mod+m exec ~/bin/play_in_mpv.sh
	$mod+Shift+m exec ~/bin/play_in_mpv.sh --vid=no
	$mod+q exec emacs_calc.sh
	$mod+Semicolon exec emacs_read_new_email.sh; pkill -SIGRTMIN+1 waybar
	$mod+Shift+Semicolon exec $term aerc
	$mod+g exec makoctl invoke

	$mod+h focus left
	$mod+j focus down
	$mod+k focus up
	$mod+l focus right
	$mod+Left focus left
	$mod+Down focus down
	$mod+Up focus up
	$mod+Right focus right

	$mod+Shift+h move left 50px
	$mod+Shift+j move down 50px
	$mod+Shift+k move up 50px
	$mod+Shift+l move right 50px
	$mod+Shift+Left move left 50px
	$mod+Shift+Down move down 50px
	$mod+Shift+Up move up 50px
	$mod+Shift+Right move right 50px

	# focus workspace
	$mod+1 workspace number 1
	$mod+2 workspace number 2
	$mod+3 workspace number 3
	$mod+4 workspace number 4
	$mod+5 workspace number 5
	$mod+6 workspace number 6
	$mod+7 workspace number 7
	$mod+8 workspace number 8
	$mod+9 workspace number 9
	$mod+0 workspace number 10

	# move focused container to workspace
	$mod+Shift+1 move container to workspace number 1
	$mod+Shift+2 move container to workspace number 2
	$mod+Shift+3 move container to workspace number 3
	$mod+Shift+4 move container to workspace number 4
	$mod+Shift+5 move container to workspace number 5
	$mod+Shift+6 move container to workspace number 6
	$mod+Shift+7 move container to workspace number 7
	$mod+Shift+8 move container to workspace number 8
	$mod+Shift+9 move container to workspace number 9
	$mod+Shift+0 move container to workspace number 10

	$mod+grave workspace back_and_forth

	$mod+b splith
	$mod+v splitv

	$mod+s layout stacking
	$mod+w layout tabbed
	$mod+e layout toggle split

	$mod+f fullscreen

	$mod+Shift+space floating toggle

	$mod+space focus mode_toggle

	$mod+a focus parent

	$mod+d focus child

	$mod+Shift+equal floating enable; sticky toggle
	$mod+equal sticky toggle

	$mod+Shift+minus move scratchpad
	$mod+minus scratchpad show

	$mod+t exec i3_balance_workspace
	$mod+Shift+t exec i3_balance_workspace --scope focus

	$mod+p exec passmenu
}


floating_modifier $mod normal
workspace_auto_back_and_forth yes

bar {
	position bottom

	swaybar_command waybar
	colors {
		statusline #ffffff
		background #000000
	}
}

hide_edge_borders vertical

seat * hide_cursor 10000

for_window {
	[app_id="firefox" title="(?i)^picture-in-picture"] floating enable, sticky enable
	[app_id="firefox" title="Firefox â€” Sharing Indicator"] floating enable, kill
	[app_id="floating_window"] floating enable
	[class="floating_window"] floating enable
}

exec {
	mako
	ydotoold
	libinput-gestures-setup start
	$wlsunset_toggle
	/usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1
	nm-applet --indicator
	blueman-applet
	swayidle -w timeout 600 'swaymsg "output * dpms off"' resume 'swaymsg "output * dpms on"' before-sleep 'swaylock -f; playerctl pause'
	poweralertd

	dbus-update-activation-environment --systemd DISPLAY WAYLAND_DISPLAY XDG_CURRENT_DESKTOP=sway
}

exec_always "pkill kanshi; kanshi"

include `hostname`
